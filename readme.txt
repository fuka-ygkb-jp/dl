+----------------------------------------------------------------+
| ダウンロードカウンタ                                           |
|                        (c)2016 不可思議絵の具(http://ygkb.jp/) |
+----------------------------------------------------------------+

■概要
名前の通り、ダウンロード数や絵の閲覧数をカウントするスクリプトです。
原理上、URLでリンクを張る事が出来る物(CGI除く)は全てカウントできます。
とにかく軽く、さっくりログを見よう、がモットーですので、数を数える
以外の機能はありません。


■導入
☆解凍☆
dl.zipを解凍します。

dl.cgi        (本体)
dlv.cgi       (ログ表示)
readme.txt    (これ)


☆導入☆
サーバに、以下のような形でアップロードして下さい。
                                     (パーミッション)
/cgi-bin/                            (705) drwx---r-x
    |--- /dl/                        (705) drwx---r-x
          |-- dl.cgi                 (705) -rwx---r-x
          |-- dlv.cgi                (705) -rwx---r-x
          |-- /log/                  (705) drwx---r-x  (ログ格納場所)
                |-- logfile.zip.log  (606) -rw----rw-
                |-- logfile.jpg.log  (606) -rw----rw-


※注
[log]ディレクトリは自分で作って下さい。

[logfile.zip.log]ってやつと[logfile.jpg.log]は例えなのでこの名前で
アップしなくても良いですよ。

アップロードの際は文字コード【UTF-8 BOM無し】【テキストモード】で
アップロードしてください。
特にWindowsのメモ帳で*.cgiファイルを修正すると【BOM有り】に
なってしまうので他のエディタをお使いください。


☆設定☆
dl.cgi, dlv.cgiをテキストエディタで開き、一行目のperlへのパスを
あなたの入会しているプロバイダに合わせて変更して下さい。

次に、ログファイルを保存するディレクトリを指定します。
特に事情がないならデフォルトの　'log/' のままで良いでしょう。


☆導入２☆
今度はログファイルを作りましょう。
いたずら防止の為、自動的にログファイルを作らずに、いちいち空のファ
イルを作ってからアップロードしなければいけないようにしています。

１．空のファイルを作ります。
　　Windowsなら[右クリック→新規作成→テキスト文書]で作れます。
　　UNIXなら  [touch logfile.log]  …だったっけ？(^^;

２．作った空のファイルの名前を変更します。
　　命名には規則があります。　間違えないようにして下さい。

　　例えば、 abc.zip というファイルをカウントしたいとします。
　　その場合は abc.zip.log という名前にします。

　　また、   abc.gif という画像の閲覧数をカウントしたいとします。
　　その場合は abc.gif.log という名前にします。

　　要はファイル名の一番後ろに .log を付けます。

３．[1.][2.]を繰り返して必要な分のログファイルを用意します。

４．準備が完了したら、ファイルをサーバにアップロードしてパーミッショ
　　ンを(606)にします。
　　これをやっておかないと、正常動作したように見えてもカウンタの値
　　が増えずに「どうして？」となるハメになります。


☆使い方☆
前節でログファイルを作ったという前提で話を進めます。

先程でも出た、 abc.zip というファイルをダウンロードしてもらう例を
書いてみます。

ダウンロードさせるページに、
<a href="./cgi-bin/dl/dl.cgi?http://www.hoge.ne.jp/pub/abc.zip">DL可</a>
                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
このようなタグを打ち込みます。
～dl.cgi? までは呼び出すHTMLから見た dl.cgi への相対パスです。
そして、そのあとに実際に abc.zip が置かれている場所を
☆URLで☆
記述します。

実際に自分でダウンロード(クリック)してみて、いつも通りにディスク
に保存でき(画面に画像が表示され)、かつカウンターの数値も上昇して
いたら成功です。

カウント数を見る場合は
http://【DLを設置したURL】/dlv.cgi を呼び出します。


☆更新履歴☆
1.1 2016/08/25 ログビューア：出力結果をHTML5化
1.0 2000/07/28 ログビューア追加
0.2 1999/08/11 一般公開
0.1 1998/09/17 プロトタイプ
